<!doctype html>
<html lang="en">
  <head>
    <title>WiiU Video</title>
    <meta charset="utf-8">
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="/nowjs/now.js"></script>
    <script src="http://popcornjs.org/code/dist/popcorn-complete.js"></script>
    <script>
    //var mediapath='../video';
    $(document).ready(function(){
      var popcorn=Popcorn('#video');
      now.ready(function(){
        now.getList();
        popcorn.footnote({
          /*
          start:2,
          end:5,
          target:'footnote',
          text:'Pop!'
          */
        });
        popcorn.on('ended',function(){
          console.log('video has ended');
          /*
          $($('video').children()[0]).attr('src','http://www.808.dk/pics/video/gizmo.mp4');
          popcorn.load();
          popcorn.play();
          */
        });
      });
      now.createDirectoryList=function(list){
        $('#list').empty();
        $.each(list,function(key,dir){
            var dirdiv=jQuery('<div/>',{text:dir.name+' (subdirs: '+dir.subdirs.length+', vids: '+dir.vids.length+')'}).appendTo($('#list'));
            var vidsdiv=jQuery('<div/>',{}).appendTo(dirdiv);
            dirdiv.click(function(){
              if(vidsdiv[0].children.length==0){
                // list divs
                $.each(dir.vids,function(key,vid){
                  var viddiv=jQuery('<div/>',{text:vid.name}).appendTo(vidsdiv);
                  viddiv.on('click',function(){
                    $($('video').children()[0]).attr('src',vid.url);
                    popcorn.load();
                    popcorn.play();
                  });
                });
              }else{
                // remove divs
                vidsdiv.empty();
              }
            });
        });
      }
    });
    document.addEventListener('DOMContentLoaded',function(){},false);
    </script>
  </head>
  <body>
    <!--
    <video id="video" src="http://v2v.cc/~j/theora_testsuite/320x240.ogg" controls>
    <video id="video" src="/video/theoratest.ogg" type="video/ogg" controls>
    <video id="video" controls>
      <source src="/video/Pokemon - s02e099 - Tracey Gets Bugged.mp4" type="video/mp4"></source>
      <source src="/video/theoratest.ogg" type="video/ogg"></source>
      <source src="/video/theoratest.ogg" type="video/ogg"></source>
      <source src="http://videos.mozilla.org/serv/webmademovies/popcornplug.mp4"></source>
      <span>Your browser does not support the <code>video</code> element.</span>
    </video>
    <div style="display:none;">
      <button onclick="document.getElementById('video').play()">Play</button>
      <button onclick="document.getElementById('video').pause()">Pause</button>
      <button onclick="document.getElementById('video').volume+=0.1">Volume+</button>
      <button onclick="document.getElementById('video').volume-=0.1">Volume-</button>
    </div>
    -->
    <video height="180" width="300" id="video"controls>
      <source src="http://localhost:9000/episodes/The%20Walking%20Dead/Season%202/The%20Walking%20Dead%20-%20s02e11%20-%20Judge%20Jury%20Executioner.mp4"></source>
      <!--
      <source src="http://videos.mozilla.org/serv/webmademovies/popcornplug.ogv">
      <source src="http://videos.mozilla.org/serv/webmademovies/popcornplug.webm">
      -->
    </video>
    <div id="footnote"></div>
    <div id="list">
      <span>Your list is empty.</span>
    </div>
  </body>
</html>